发行包的制作
============

此节主要描述 Windows 平台安装包的制作。因为 Windows 默认不带 Python
运行环境，所以有必要单独制作符合 Windows 用户习惯的安装包。对于 \*nix
系统而言，只要将姜大虾的目录结构解压至合适的目录，就完成了安装。

Windows 平台
------------

姜大虾目前使用 ``py2exe`` 制作可执行文件以摆脱对 Python 环境的依赖，用
NSIS 实现安装程序。写了一些小脚本和批处理来自动化打包中各种处理过程。

下面简要描述下制作方法。基本上分两步，第一步制作出可执行文件还有合适的库文件
压缩包，第二步制作安装程序。

1. ``interface`` 目录下执行 ``python -OO winmain.pyw``\ ，
   这样编译所有涉及到的源代码文件为 pyo 格式；

2. ``make_rel.bat``\ ，调用 ``py2exe``\ ，以及删减库文件包；

3. 编译 ``deploy`` 目录中的 NSIS 脚本，制作安装程序。

.. note::
    你需要把 7-Zip 主程序（\ ``7z.exe``\ ）还有 UPX 放在系统的 ``PATH``
    环境变量里面！

.. vi:ai:et:ts=4 sw=4 sts=4 ff=unix fenc=utf-8 syntax=rst
